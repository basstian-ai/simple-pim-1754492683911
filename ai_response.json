{
  "patch": "--- a/pages/index.js\n+++ b/pages/index.js\n@@ -1,38 +1,60 @@\n import React, { useEffect, useState } from 'react';\n import ProductList from '../components/ProductList';\n \n const Home = () => {\n   const [products, setProducts] = useState([]);\n   const [query, setQuery] = useState('');\n \n   useEffect(() => {\n     let active = true;\n     const controller = new AbortController();\n \n     const fetchProducts = async () => {\n       const qs = query ? `?search=${encodeURIComponent(query)}` : '';\n       const res = await fetch(`/api/products${qs}`, { signal: controller.signal });\n       const data = await res.json();\n       if (active) setProducts(data);\n     };\n \n     const t = setTimeout(fetchProducts, 250);\n \n     return () => {\n       active = false;\n       controller.abort();\n       clearTimeout(t);\n     };\n   }, [query]);\n \n+  const csvHref = `/api/products/export${query ? `?search=${encodeURIComponent(query)}` : ''}`;\n+\n   return (\n     <div style={{ maxWidth: 900, margin: '0 auto', padding: '1rem' }}>\n-      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '1rem' }}>\n+      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '1rem' }}>\n         <input\n           type=\"search\"\n           placeholder=\"Search products by name, SKU or description...\"\n           value={query}\n           onChange={(e) => setQuery(e.target.value)}\n           style={{ flex: 1, padding: '0.5rem 0.75rem', border: '1px solid #ddd', borderRadius: 6 }}\n           aria-label=\"Search products\"\n         />\n-        <span style={{ color: '#666', fontSize: 12 }}>\n-          {products?.length || 0} result{(products?.length || 0) === 1 ? '' : 's'}\n-        </span>\n+        <span style={{ color: '#666', fontSize: 12 }}>\n+          {products?.length || 0} result{(products?.length || 0) === 1 ? '' : 's'}\n+        </span>\n+        <a\n+          href={csvHref}\n+          download\n+          data-testid=\"export-csv-link\"\n+          style={{\n+            textDecoration: 'none',\n+            background: '#111827',\n+            color: 'white',\n+            padding: '0.5rem 0.75rem',\n+            borderRadius: 6,\n+            fontSize: 12,\n+            whiteSpace: 'nowrap'\n+          }}\n+        >\n+          Export CSV\n+        </a>\n       </div>\n       <ProductList products={products} />\n     </div>\n   );\n };\n \n export default Home;\n",
  "files": [
    {
      "path": "tests/exportCsvLink.test.js",
      "content": "import React from 'react';\nimport { render, screen } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport Home from '../pages/index';\n\ndescribe('Home page Export CSV', () => {\n  beforeEach(() => {\n    global.fetch = jest.fn(() =>\n      Promise.resolve({\n        json: () => Promise.resolve([])\n      })\n    );\n  });\n\n  afterEach(() => {\n    jest.resetAllMocks();\n  });\n\n  it('renders an Export CSV link pointing to the API', () => {\n    render(<Home />);\n    const link = screen.getByRole('link', { name: /export csv/i });\n    expect(link).toBeInTheDocument();\n    expect(link.getAttribute('href')).toMatch(/^\\/api\\/products\\/export/);\n  });\n});\n"
    }
  ]
}